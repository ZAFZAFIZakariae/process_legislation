{% extends "base.html" %}
{% block title %}SQL Query{% endblock %}
{% block content %}
<h1>Run SQL Query</h1>
<form class="card" method="post">
    <label>Predefined:
        <select id="preset" onchange="setPreset(this)">
            <option value="">Custom...</option>
            {% for name in queries.keys() %}
            <option value="{{ name }}">{{ name }}</option>
            {% endfor %}
        </select>
    </label>
    <label>SQL:
        <textarea id="sql" name="sql" rows="6">{{ sql }}</textarea>
    </label>
    <button type="submit">Execute</button>
</form>
{% if error %}
<section class="card" style="color:red;">
    <p>{{ error }}</p>
</section>
{% endif %}
{% if result_html %}
<section class="card">
    <h2>Results</h2>
    <div>{{ result_html|safe }}</div>
</section>
{% endif %}
{% endblock %}
{% block scripts %}
<script>
const presets = {{ queries|tojson }};
function setPreset(sel) {
    const q = presets[sel.value] || '';
    document.getElementById('sql').value = q;
}
</script>
{% endblock %}
