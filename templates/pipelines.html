<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Pipelines</title>
<link rel="stylesheet" href="{{ url_for('static', filename='main.css') }}">
<script defer src="{{ url_for('static', filename='app.js') }}"></script>
</head>
<body>
<aside class="sidebar" data-collapsed="false">
  <button class="sidebar-toggle btn ghost" aria-label="Toggle sidebar">â˜°</button>
  <nav>
    <a href="{{ url_for('home') }}" class="nav-link">Dashboard</a>
    <a href="{{ url_for('corpus') }}" class="nav-link">Corpus</a>
    <a href="{{ url_for('document') }}" class="nav-link">Document</a>
    <a href="{{ url_for('graph_page') }}" class="nav-link">Graph</a>
    <a href="{{ url_for('pipelines_page') }}" class="nav-link active">Pipelines</a>
    <a href="{{ url_for('sql_lab') }}" class="nav-link">SQL Lab</a>
    <a href="{{ url_for('settings_page') }}" class="nav-link">Settings</a>
  </nav>
</aside>
<div class="main" style="flex:1;display:flex;flex-direction:column;min-height:100vh;">
<header class="topbar">
  <div class="breadcrumbs">Pipelines</div>
  <div class="actions" style="display:flex;gap:.5rem;">
    <button class="btn ghost" data-action="open-palette" aria-label="Command palette">âŒ˜K</button>
    <button class="btn ghost" data-action="theme-toggle" aria-label="Toggle theme">ðŸŒ—</button>
  </div>
</header>
<main class="page">
  <div class="card">
    <h1>Run Pipeline</h1>
    {% if error %}<p style="color:red">{{ error }}</p>{% endif %}
    <form method="post" enctype="multipart/form-data" style="display:flex;flex-direction:column;gap:.5rem;max-width:400px;">
      <label>Document <input type="file" name="file" required></label>
      <label>Model <input type="text" name="model" value="gpt-4o"></label>
      <button type="submit" class="btn">Run</button>
    </form>
  </div>
  <div class="card">
    <h2>Available Runs</h2>
    {% if runs %}
    <table>
      <thead><tr><th>Name</th><th>Structure</th><th>NER</th><th>Decision</th></tr></thead>
      <tbody>
      {% for r in runs %}
        <tr>
          <td>{{ r.name }}</td>
          <td>{% if r.structure %}<a href="{{ url_for('download_output', filename=r.structure) }}">{{ r.structure }}</a>{% else %}-{% endif %}</td>
          <td>{% if r.ner %}<a href="{{ url_for('download_ner_output', filename=r.ner) }}">{{ r.ner }}</a>{% else %}-{% endif %}</td>
          <td>{% if r.decision %}<a href="{{ url_for('download_output', filename=r.decision) }}">{{ r.decision }}</a>{% else %}-{% endif %}</td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
    {% else %}
      <p>No runs found.</p>
    {% endif %}
  </div>
</main>
</div>
<div id="palette" class="palette hidden" role="dialog" aria-modal="true">
  <div class="palette-content">
    <input type="text" placeholder="Search commands" aria-label="Command">
    <ul></ul>
  </div>
</div>
<div id="toasts" class="toasts"></div>
</body>
</html>
